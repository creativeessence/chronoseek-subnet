# Pattern: External Activity Verification
# Example: Gittensor (SN74)

metadata:
  name: external_activity_verification
  category: external
  examples: ["Gittensor SN74"]

when_to_use:
  commodity: "verifiable external activity"
  value_source: "third-party API provides ground truth"
  miner_serving: "not required (no real-time endpoint)"

architecture:
  miner:
    registration: "hotkey on subnet"
    identity_link: "provide PAT (Personal Access Token)"
    activity: "perform work on external platform"
    requirement: "tagline in contributions"
    example_tagline: "Mining $OGX - Hotkey {github_id}"
  
  validator:
    phases:
      1_data_fetch:
        source: "external API (e.g., GitHub)"
        filter: "by time window (lookback period)"
      
      2_eligibility_filtering:
        checks:
          - repository_eligible: "stars, activity"
          - not_self_merged: "author != merger"
          - not_maintainer: "branch rules met"
          - tagline_present: "required marker"
      
      3_contribution_scoring:
        analyzes:
          - file_diffs
          - language_weights
          - test_file_downweight
          - low_value_detection
      
      4_multipliers:
        - repository_weight: "more active = higher"
        - issue_linking_bonus
        - open_pr_penalty: "uncommitted collateral"
        - time_decay
        - uniqueness: "not copying others"
        - missing_tagline: "= zero score"
      
      5_duplicate_detection:
        - same_github_on_multiple_hotkeys
        - penalize_all_but_first

anti_gaming:
  self_merge_detection: "author != merger check"
  maintainer_filtering: "exclude repo maintainers"
  low_value_pr_detection: "trivial changes scored low"
  duplicate_account_penalty: "one account per hotkey"
  tagline_requirement: "gates rewards"

no_server_pattern:
  miner_runs: "no server"
  miner_does: "external platform activity"
  validator_reads: "external API directly"

selection_criteria:
  use_when:
    - value_from_external_platform
    - api_provides_ground_truth
    - activity_publicly_verifiable
  
  dont_use_when:
    - real_time_queries_needed
    - external_api_unreliable
    - activity_not_publicly_visible
