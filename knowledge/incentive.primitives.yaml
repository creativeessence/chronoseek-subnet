# Incentive Mechanism Primitives

design_process:
  1_define_commodity: "What value do miners provide?"
  2_define_quality: "How is 'good' measured?"
  3_design_verification: "How do validators confirm quality?"
  4_identify_attacks: "How could miners cheat?"
  5_add_anti_gaming: "How to prevent/detect cheating?"
  6_convert_to_weights: "How do scores become emissions?"
  7_test_iterate: "Simulate, deploy testnet, adjust"

commodity_types:
  inference:
    examples: ["text generation", "image generation"]
    challenge: "quality scoring"
  
  compute:
    examples: ["GPU hours", "VM capacity"]
    challenge: "hardware verification"
  
  data:
    examples: ["scraped content", "indexed datasets"]
    challenge: "uniqueness, freshness"
  
  predictions:
    examples: ["price forecasts", "weather predictions"]
    challenge: "delayed ground truth"
  
  external_work:
    examples: ["GitHub PRs", "creative content"]
    challenge: "third-party verification"
  
  availability:
    examples: ["uptime", "response time"]
    challenge: "consistent monitoring"

quality_dimensions:
  accuracy:
    question: "Does output match expected?"
    requires: "ground truth comparison"
  
  speed:
    question: "How fast is response?"
    measurement: "latency in ms"
  
  reliability:
    question: "What percentage succeed?"
    measurement: "success rate over time"
  
  uniqueness:
    question: "Is output copied?"
    measurement: "similarity analysis"
  
  cost_efficiency:
    question: "What's the price?"
    measurement: "lower cost = higher value"

verification_methods:
  direct:
    when: "quality assessable immediately"
    example: "grammar check on text"
  
  delayed:
    when: "ground truth arrives later"
    example: "prediction scoring after event"
    requires: "pending storage, temporal tracking"
    tool: "hippius.integration.yaml for timestamped storage"
  
  sampling:
    when: "can't verify everything"
    example: "data indexing"
    method: "verify sample, extrapolate"
  
  external:
    when: "third party has ground truth"
    example: "github api"
    requires: "api access, identity linking"
  
  hardware:
    when: "need to verify physical resources"
    example: "gpu attestation"
    method: "cryptographic proofs, TEE"
  
  adversarial:
    when: "miners verify each other"
    example: "red team / blue team"
    benefit: "validators don't control ground truth"

scoring_formulas:
  ema:
    formula: "new_score = alpha * instant + (1-alpha) * old"
    alpha_range: [0.01, 0.5]
    purpose: "smooth noise, build reputation"
  
  crps:
    name: "Continuous Ranked Probability Score"
    use_when: "distribution predictions"
    better: "lower score"
    conversion: "1.0 - min(crps, 1.0)"
  
  scorable_bytes:
    formula: "(miner_bytes^2) / total_bytes"
    purpose: "penalize duplication"
    effect: "unique data scores higher"
  
  credibility:
    formula: "verification_success_ema ^ 2.5"
    purpose: "exponential penalty for failures"

weight_conversion:
  normalization:
    constraint: "weights sum to 1"
    zero_handling: "uniform distribution"
  
  softmax:
    formula: "exp(score/temp) / sum(exp)"
    temperature_low: "winner-take-most"
    temperature_high: "more equal distribution"
  
  inverse:
    use_when: "lower score is better"
    method: "negative beta in softmax"

anti_gaming_measures:
  coldkey_deduplication:
    method: "highest scorer per coldkey wins"
    limitation: "NOT sybil-proof"
  
  credibility_tracking:
    method: "EMA of verification success"
    multiplier: "credibility^2.5"
  
  time_decay:
    formula: "score * exp(-age * ln(2) / half_life)"
    purpose: "reward freshness"
  
  uniqueness_scoring:
    exact_match: "1.0 / match_count"
    data_based: "scorable_bytes formula"

testing:
  simulation:
    add: ["honest miners", "gaming miners"]
    run: "multiple epochs"
    verify: "honest > gaming earnings"
  
  testnet:
    steps:
      - deploy_mechanism
      - run_test_miners
      - verify_distribution
      - test_attack_scenarios
      - adjust_parameters
  
  monitoring:
    metrics:
      - emission_concentration
      - weight_pattern_diversity
      - validator_stake_distribution
    alerts:
      - top_10pct_above_80pct
      - weight_copying_detected
      - single_validator_dominates
