# Miner Rules
# Constraints and guidance for miner behavior

development:
  no_provided_code:
    rule: "Subnet owners NEVER write miner code"
    implication: "Miners read validator.py to understand interface"
    competition: "through innovation, not copying reference"

  open_source:
    preference: "open source implementations"
    benefits:
      - auditable_by_validators
      - learnable_by_other_miners
      - constrained_attack_surface

communication:
  deprecated:
    - axon
    - dendrite
    - synapse
  
  recommended:
    protocol: http_rest
    signing: epistula
    discovery: chain_commitments

  endpoint_commitment:
    method: "subtensor.set_commitment(wallet, netuid, data)"
    data_types:
      - api_urls
      - s3_urls
      - database_endpoints
      - model_identifiers
      - docker_images
    format: "JSON recommended for structured data"

patterns:
  http_api:
    recommended: true
    framework: ["fastapi", "flask"]
    requirements:
      - epistula_signature_verification
      - validator_permit_check
      - request_validation
      - proper_logging
  
  orchestrator_socket:
    use_when: "no public endpoint needed"
    protocol: socket.io
    auth: hotkey_signature
  
  external_activity:
    use_when: "value from external platforms"
    server: none_required
    example: "github contributions with tagline"
  
  container_submission:
    use_when: "competing on software quality"
    format: docker_image
    commit: "image URL to chain"
    execution: "validator runs via Basilica"

epistula_verification:
  headers:
    timestamp: "X-Epistula-Timestamp"
    signature: "X-Epistula-Signature"
    hotkey: "X-Epistula-Hotkey"
  
  validation:
    timestamp_freshness: "abs(now - ts) < 60 seconds"
    signature_verify: "keypair.verify(message, signature)"
    caller_is_validator: "check metagraph.validator_permit"

checklist:
  registration:
    - create_wallet
    - register_on_subnet
    - verify_registration
  
  endpoint:
    - implement_required_endpoints
    - add_epistula_verification
    - commit_endpoint_to_chain
  
  operation:
    - handle_requests
    - log_activity
    - monitor_incentive
  
  quality:
    - open_source_code
    - test_with_validators
    - optimize_for_scoring_criteria
