# Operational Principles

deployment_phases:
  1_local:
    purpose: "development"
    cost: "free TAO (faucet)"
    speed: "fast (~6s blocks)"
    network: "ws://127.0.0.1:9944"
  
  2_testnet:
    purpose: "testing"
    cost: "free TAO (faucet)"
    speed: "normal (~12s blocks)"
    network: "wss://test.finney.opentensor.ai:443"
  
  3_mainnet:
    purpose: "production"
    cost: "real TAO"
    speed: "normal (~12s blocks)"
    network: "wss://entrypoint-finney.opentensor.ai:443"

recommended_deployment:
  pattern: "Docker + Watchtower auto-update"
  
  benefits:
    - automatic_updates
    - consistent_environment
    - zero_coordination
    - rollback_safety
    - reduced_support_burden
  
  owner_workflow:
    1: "push to main branch"
    2: "GitHub Actions builds image"
    3: "push to Docker Hub :latest"
  
  validator_workflow:
    1: "Watchtower checks every 5 minutes"
    2: "detects new image"
    3: "pulls and restarts container"

docker_compose_template: |
  services:
    validator:
      image: subnetowner/mysubnet:latest
      restart: unless-stopped
      environment:
        - NETWORK=finney
        - NETUID=YOUR_NETUID
        - WALLET_NAME=validator
        - HOTKEY_NAME=default
      volumes:
        - ~/.bittensor/wallets:/root/.bittensor/wallets:ro
    
    watchtower:
      image: containrrr/watchtower:latest
      restart: unless-stopped
      environment:
        - WATCHTOWER_POLL_INTERVAL=300
        - WATCHTOWER_CLEANUP=true
        - WATCHTOWER_ROLLING_RESTART=true
      volumes:
        - /var/run/docker.sock:/var/run/docker.sock

github_actions_workflow:
  trigger: "push to main"
  steps:
    - checkout
    - setup_buildx
    - docker_login
    - build_push:
        tags:
          - latest
          - sha_commit
        platforms:
          - linux/amd64
          - linux/arm64

wallet_security:
  coldkey:
    - air_gapped_machine
    - hardware_wallet_if_possible
    - never_share_mnemonic
    - strong_passwords
    - multiple_secure_backups
  
  hotkey:
    - can_be_on_server
    - rotate_if_compromised

monitoring:
  miner_metrics:
    - requests_per_minute
    - average_response_time
    - error_rate
    - incentive_score
    - emission_received
  
  validator_metrics:
    - queries_sent_per_minute
    - response_success_rate
    - weight_update_frequency
    - dividend_earnings
    - metagraph_sync_status
  
  alerts:
    - service_down
    - high_error_rate_above_5pct
    - low_incentive_dividends
    - registration_dropped
    - stake_changes

operational_checklist:
  daily:
    - check_service_status
    - review_error_logs
    - verify_emissions_received
    - check_incentive_trends
  
  weekly:
    - review_metagraph_changes
    - analyze_competitor_behavior
    - check_wallet_balances
    - backup_state_databases
  
  monthly:
    - security_review
    - performance_optimization
    - cost_analysis

emergency_procedures:
  service_recovery:
    - check_status: "docker-compose ps"
    - restart: "docker-compose restart validator"
    - logs: "docker-compose logs --tail 100"
  
  rollback:
    steps:
      1: "stop container"
      2: "find previous SHA tag"
      3: "update docker-compose.yml with specific tag"
      4: "restart"
      5: "disable watchtower for container temporarily"
  
  subnet_emergency:
    disable_registrations: |
      btcli sudo set --netuid $NETUID --param registration_allowed --value false
