# Subnet Lifecycle Specification

phases:
  1_preparation:
    steps:
      - create_coldkey
      - create_hotkey
      - acquire_tao
    sdk:
      wallet_create: |
        from bittensor_wallet import Wallet
        wallet = Wallet(name="owner", hotkey="operator")
        wallet.create_if_non_existent()
    check_cost: "subtensor.get_subnet_burn_cost()"

  2_creation:
    method: "subtensor.register_network(wallet=wallet)"
    returns: "(success, netuid)"
    cost: "dynamic burn/lock"
    limit: "may prune lowest-emission subnet if full"

  3_activation:
    waiting_period_blocks: 2016
    waiting_period_approx: "24 hours"
    method: "subtensor.activate_subnet(wallet, netuid)"

  4_configuration:
    method: "subtensor.set_hyperparameter(wallet, netuid, param, value)"
    owner_only: true
    key_params:
      - tempo
      - immunity_period
      - weights_rate_limit
      - max_weights_limit
      - min_allowed_weights

  5_registration:
    methods:
      burn: "subtensor.burned_register(wallet, netuid)"
      pow: "subtensor.register(wallet, netuid)"
    controls:
      - min_burn
      - max_burn
      - difficulty
      - registration_allowed

  6_operation:
    miner_loop:
      - register
      - commit_endpoint
      - serve_requests
    validator_loop:
      - register
      - stake
      - query_miners
      - score_responses
      - set_weights

  7_maintenance:
    tuning:
      - adjust_hyperparameters
      - enable_commit_reveal_if_needed
    identity:
      method: "btcli subnet identity set"
    ownership_transfer:
      method: "subtensor.set_subnet_owner(wallet, netuid, new_owner)"

  risk_deregistration:
    trigger: "lowest emission when new subnet created"
    prevention: "maintain emission value"

hyperparameters:
  NOT_CHANGEABLE:
    - tempo: "locked despite appearing in docs"
    - max_allowed_uids: "locked"
  
  changeable:
    immunity_period:
      default: 7200
      unit: blocks
      purpose: "protection from pruning"
    
    weights_rate_limit:
      default: 100
      unit: blocks
      purpose: "min blocks between weight updates"
    
    max_weights_limit:
      default: 64
      purpose: "max UIDs in weight vector"
    
    min_allowed_weights:
      default: 1
      purpose: "min UIDs required per submission"
    
    commit_reveal_weights_enabled:
      default: false
      warning: "use only when necessary"
      purpose: "prevent weight copying"
    
    commit_reveal_period:
      default: 0
      note: "50-100 blocks insufficient; need longer"
    
    min_burn:
      purpose: "registration cost floor"
    
    difficulty:
      default: 10_000_000
      purpose: "pow registration difficulty"

epoch:
  trigger: "every tempo blocks"
  process:
    1: "filter active neurons"
    2: "identify validators"
    3: "process weight matrix"
    4: "calculate stake-weighted median consensus"
    5: "calculate trust"
    6: "calculate rank and incentive"
    7: "update bonds (EMA with liquid alpha)"
    8: "calculate dividends"
    9: "distribute emissions"
  
  emission_split:
    miners: 0.41
    validators: 0.41
    owner: 0.18

  formulas:
    incentive: "rank[m] / total_rank"
    dividend: "sum(bond[v][m] * incentive[m])"
    miner_reward: "miner_pool * incentive"
    validator_reward: "validator_pool * dividends"
